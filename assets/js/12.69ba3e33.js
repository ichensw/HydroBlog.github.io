(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{518:function(s,a,n){"use strict";n.r(a);var t=n(3),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"nacos微服务注册地址为内网ip的解决办法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nacos微服务注册地址为内网ip的解决办法"}},[s._v("#")]),s._v(" Nacos微服务注册地址为内网IP的解决办法")]),s._v(" "),n("h2",{attrs:{id:"nacos服务注册的ip"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nacos服务注册的ip"}},[s._v("#")]),s._v(" Nacos服务注册的IP")]),s._v(" "),n("p",[s._v("Nacos注册中心是: https://github.com/alibaba/nacos\n各个服务通过Nacos客户端将服务信息注册到Nacos上\n当Nacos服务注册的IP默认选择出问题时，可以通过查阅对应的客户端文档，来选择配置不同的网卡或者IP\n（参考org.springframework.cloud.alibaba.nacos.NacosDiscoveryProperties的配置）")]),s._v(" "),n("p",[s._v("例如，使用了Spring cloud alibaba（"),n("a",{attrs:{href:"https://github.com/spring-cloud-incubator/spring-cloud-alibaba",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),n("OutboundLink")],1),s._v("）作为Nacos客户端，\n服务默认获取了内网IP 192.168.1.21,\n可以通过配置spring.cloud.inetutils.preferred-networks=10.34.12，使服务获取内网中前缀为10.34.12的IP")]),s._v(" "),n("h2",{attrs:{id:"如何配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何配置"}},[s._v("#")]),s._v(" 如何配置")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果选择固定Ip注册可以配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.cloud.nacos.discovery.ip")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10.2.11.11")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.cloud.nacos.discovery.port")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("9090")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果选择固定网卡配置项")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.cloud.nacos.discovery.networkInterface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("eth0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果想更丰富的选择，可以使用spring cloud 的工具 InetUtils进行配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 具体说明可以自行检索: https://github.com/spring-cloud/spring-cloud-commons/blob/master/docs/src/main/asciidoc/spring-cloud-commons.adoc")]),s._v("\nspring.cloud.inetutils.default-hostname\nspring.cloud.inetutils.default-ip-address\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.cloud.inetutils.ignored-interfaces[0]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("eth0 \t# 忽略网卡，eth0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.cloud.inetutils.ignored-interfaces")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("eth.* \t# 忽略网卡，eth.*，正则表达式")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.cloud.inetutils.preferred-networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10.34.12 \t# 选择符合前缀的IP作为服务注册IP")]),s._v("\nspring.cloud.inetutils.timeout-seconds\nspring.cloud.inetutils.use-only-site-local-interfaces\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h2",{attrs:{id:"nacos更多配置信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nacos更多配置信息"}},[s._v("#")]),s._v(" Nacos更多配置信息")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[s._v("spring.cloud.nacos.discovery.server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("addr  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Nacos Server 启动监听的ip地址和端口")]),s._v("\nspring.cloud.nacos.discovery.service  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#给当前的服务命名")]),s._v("\nspring.cloud.nacos.discovery.weight  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#取值范围 1 到 100，数值越大，权重越大")]),s._v("\nspring.cloud.nacos.discovery.network"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("interface "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当IP未配置时，注册的IP为此网卡所对应的IP地址，如果此项也未配置，则默认取第一块网卡的地址")]),s._v("\nspring.cloud.nacos.discovery.ip  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 优先级最高")]),s._v("\nspring.cloud.nacos.discovery.port  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认情况下不用配置，会自动探测")]),s._v("\nspring.cloud.nacos.discovery.namespace "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常用场景之一是不同环境的注册的区分隔离，例如开发测试环境和生产环境的资源（如配置、服务）隔离等。")]),s._v("\n\nspring.cloud.nacos.discovery.access"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("key  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当要上阿里云时，阿里云上面的一个云账号名")]),s._v("\nspring.cloud.nacos.discovery.secret"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("key "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当要上阿里云时，阿里云上面的一个云账号密码")]),s._v("\nspring.cloud.nacos.discovery.metadata    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用Map格式配置，用户可以根据自己的需要自定义一些和服务相关的元数据信息")]),s._v("\nspring.cloud.nacos.discovery.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("name   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志文件名")]),s._v("\nspring.cloud.nacos.discovery.enpoint   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 地域的某个服务的入口域名，通过此域名可以动态地拿到服务端地址")]),s._v("\nribbon.nacos.enabled  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否集成Ribbon 默认为true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);