(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{537:function(s,t,a){"use strict";a.r(t);var n=a(3),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"ä¸€ã€redisåœ¨é«˜å¹¶å‘ä¸‹å¯èƒ½ä¼šå­˜åœ¨å“ªå„¿äº›é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€redisåœ¨é«˜å¹¶å‘ä¸‹å¯èƒ½ä¼šå­˜åœ¨å“ªå„¿äº›é—®é¢˜"}},[s._v("#")]),s._v(" ä¸€ã€Redisåœ¨é«˜å¹¶å‘ä¸‹å¯èƒ½ä¼šå­˜åœ¨å“ªå„¿äº›é—®é¢˜ï¼Ÿ")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("ç¼“å­˜ç©¿é€ï¼šå½“ç”¨æˆ·å‘é€è¯·æ±‚æ—¶ï¼ŒRedisä¸­æ²¡æœ‰æ•°æ®å¹¶å‘æ•°æ®åº“æŸ¥è¯¢æ—¶ï¼Œæ•°æ®åº“åŒæ—¶ä¹Ÿæ²¡æœ‰æ•°æ®ï¼Œåˆ™æ­¤æ—¶ä¼šè¶Šè¿‡Redisç¼“å­˜ç›´æ¥å°†nullç©ºæ•°æ®å‘é€ç»™ç”¨æˆ·ã€‚")]),s._v(" "),a("p",[s._v("è§£å†³æ–¹æ¡ˆï¼šå½“RedisæŸ¥è¯¢æ•°æ®åº“æ—¶ï¼Œå¢åŠ åˆ¤æ–­æ¡ä»¶ï¼Œä¸ºnullç©ºå€¼èµ‹å€¼ä¸€ä¸ªé»˜è®¤å€¼")])]),s._v(" "),a("li",[a("p",[s._v("ç¼“å­˜é›ªå´©ï¼šRedisç¼“å­˜è®¾ç½®åˆ°æœŸæ—¶é—´æ—¶ï¼Œå½“åˆ°æœŸæ—¶é—´ç›¸åŒæ—¶ï¼Œç¼“å­˜åŒæ—¶åˆ°æœŸï¼Œåˆ™è¯·æ±‚éƒ½ä¼šå‘é€åˆ°æ•°æ®åº“ï¼Œé€ æˆè¯·æ±‚æ•°æ®æ‹¥æŒ¤ã€‚")]),s._v(" "),a("p",[s._v("è§£å†³æ–¹æ¡ˆï¼šæš‚æ— è¾ƒå¥½è§£å†³æ–¹æ¡ˆï¼Œå°½é‡å°†ç¼“å­˜çš„åˆ°æœŸæ—¶é—´å²”å¼€ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("çƒ­ç‚¹ç¼“å­˜ï¼šè®¾ç½®ç¼“å­˜åˆ°æœŸæ—¶é—´åˆ™ä¼šæœ‰å¯èƒ½å‘ç”Ÿæ­¤æƒ…å†µï¼Œå½“ä¸€ä¸ªç¼“å­˜åˆ°æœŸçš„ä¸€ç¬é—´ï¼Œçªå‘å¤§é‡è¯·æ±‚ï¼Œæ— æ³•æŸ¥è¯¢åˆ°ç¼“å­˜æ—¶ï¼Œè¯·æ±‚ä¼šç›´æ¥æŸ¥è¯¢æ•°æ®åº“ï¼Œé€ æˆæ‹¥æŒ¤ã€‚")]),s._v(" "),a("p",[s._v("è§£å†³æ–¹æ¡ˆï¼šåŒé‡æ£€æµ‹é”æœºåˆ¶")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨åŒé‡æ£€æµ‹é”")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findStudentsCount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–Redisæ“ä½œå¯¹è±¡")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BoundValueOperations")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" ops "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("boundValueOps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"count"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä»Redisè·å–æŒ‡å®škeyçš„value")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectStudentsCount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä»¥ä¸‹è¯­å¥çš„åº•å±‚ç”±ä»¥ä¸‹æ­¥éª¤å®Œæˆï¼š")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1. ç”³è¯·ä¸€ä¸ªå†…æ ¸ç¼“å­˜ç©ºé—´m")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2. å°†ç”¨æˆ·ç©ºé—´ä¸­çš„countå€¼è¯»å–åˆ°å†…æ ¸ç©ºé—´m")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3. å°†å†…æ ¸ç©ºé—´mä¸­çš„æ•°æ®ä¼ é€’ç»™set()æ–¹æ³•ä¸­çš„å½¢å‚(å†…æ ¸ç©ºé—´ -> ç”¨æˆ·ç©ºé—´)")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4. set()æ–¹æ³•ä¼šå°†æ•°æ®ä¼ é€’åˆ°åè®®å¼•æ“ProtocolEngine(ç”¨æˆ·ç©ºé—´ -> å†…æ ¸ç©ºé—´)")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 5. åè®®å¼•æ“å°†æ•°æ®é€šè¿‡ç½‘ç»œä¼ é€’åˆ°Redis")]),s._v("\n                ops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SECONDS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"äºŒã€åŒé‡æ£€æµ‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€åŒé‡æ£€æµ‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜"}},[s._v("#")]),s._v(" äºŒã€åŒé‡æ£€æµ‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @author ä¸€æ¡é±¼\n * @date 2021/6/28 18:26\n *\n * å½“å‰ä»£ç å­˜åœ¨çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š\n * è§£å†³æ–¹æ¡ˆæœ‰ä¸‰ç§ï¼š\n * 1ï¼‰åœ¨æ–¹æ³•å‰é¢æ·»åŠ synchronizedï¼Œä½¿å¾—æ–¹æ³•å˜æˆåŒæ­¥æ–¹æ³•\n * 2ï¼‰åœ¨å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„æˆå‘˜å˜é‡å£°æ˜å‰æ·»åŠ volatileï¼Œæ­¤å…³é”®å­—èƒ½å¤Ÿä½¿å˜é‡èµ‹å€¼çš„åº•å±‚å®ç°æ­¥éª¤å¼ºåˆ¶æŒ‰é¡ºåºæ‰§è¡Œ\n * 3ï¼‰è‹¥å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„æˆå‘˜å˜é‡ä¸ºIntegerã€Longã€Booleanç­‰ï¼Œå¯ä»¥å°†ä»–ä»¬å®šä¹‰ä¸ºAtomicInteger....ç­‰ï¼Œ\n *    æ­¤å…³é”®å­—æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StudentFactory")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("volatile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Student")]),s._v(" student"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Student")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("student "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("student "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n                     ä»¥ä¸‹è¯­å¥åº•å±‚åŸç†å®ç°ç”±ä¸‰æ­¥æ„æˆ\n                     1. ç”³è¯·å †ç©ºé—´m\n                     2. ä½¿ç”¨å¯¹è±¡çš„åˆå§‹åŒ–æ•°æ®åˆå§‹åŒ–å †ç©ºé—´m\n                     3. å°†studentå¯¹è±¡çš„å¼•ç”¨æŒ‡å‘å †ç©ºé—´m\n                     å¼•å‘çš„é—®é¢˜ï¼šå¦‚æœä¸è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„è¯ï¼Œä»¥ä¸Šä¸‰æ­¥çš„é¡ºåºå¯èƒ½ä¼šæ··ä¹±ï¼Œå¦‚æœæ‰§è¡Œé¡ºåºä¸º1 3 2ï¼Œåˆ™\n                     ä¼šå¯¼è‡´studentåˆ¤æ–­å·²ç»ä¸ç­‰äºnullæ—¶ï¼Œä½†è¿”å›æ²¡æœ‰æ•°æ®ä¸ºnullã€‚\n                      */")]),s._v("\n                    student "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Student")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"å¼ ä¸‰"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" student"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h2",{attrs:{id:"ä¸‰ã€redisåˆ†å¸ƒå¼é”é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€redisåˆ†å¸ƒå¼é”é—®é¢˜"}},[s._v("#")]),s._v(" ä¸‰ã€Redisåˆ†å¸ƒå¼é”é—®é¢˜")]),s._v(" "),a("h3",{attrs:{id:"_3-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”"}},[s._v("#")]),s._v(" 3.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”ï¼Ÿ")]),s._v(" "),a("p",[s._v("çº¿ç¨‹é”ï¼šä¸»è¦ç”¨æ¥ç»™æ–¹æ³•ã€ä»£ç å—åŠ é”ã€‚å½“æŸä¸ªæ–¹æ³•æˆ–ä»£ç ä½¿ç”¨é”ï¼Œåœ¨åŒä¸€æ—¶åˆ»ä»…æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥æ–¹æ³•æˆ–è¯¥ä»£ç æ®µã€‚çº¿ç¨‹é”åªåœ¨åŒä¸€JVMä¸­æœ‰æ•ˆæœï¼Œå› ä¸ºçº¿ç¨‹é”çš„å®ç°åœ¨æ ¹æœ¬ä¸Šæ˜¯ä¾é çº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜å®ç°çš„ï¼Œæ¯”å¦‚synchronizedæ˜¯å…±äº«å¯¹è±¡å¤´ï¼Œæ˜¾ç¤ºé”Lockæ˜¯å…±äº«æŸä¸ªå˜é‡ï¼ˆstateï¼‰ã€‚")]),s._v(" "),a("p",[s._v("è¿›ç¨‹é”ï¼šä¸ºäº†æ§åˆ¶åŒä¸€æ“ä½œç³»ç»Ÿä¸­å¤šä¸ªè¿›ç¨‹è®¿é—®æŸä¸ªå…±äº«èµ„æºï¼Œå› ä¸ºè¿›ç¨‹å…·æœ‰ç‹¬ç«‹æ€§ï¼Œå„ä¸ªè¿›ç¨‹æ— æ³•è®¿é—®å…¶ä»–è¿›ç¨‹çš„èµ„æºï¼Œå› æ­¤æ— æ³•é€šè¿‡synchronizedç­‰çº¿ç¨‹é”å®ç°è¿›ç¨‹é”ã€‚")]),s._v(" "),a("p",[s._v("åˆ†å¸ƒå¼é”ï¼šå½“å¤šä¸ªè¿›ç¨‹ä¸åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œç”¨åˆ†å¸ƒå¼é”æ§åˆ¶å¤šä¸ªè¿›ç¨‹å¯¹èµ„æºçš„è®¿é—®ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_3-2-åˆ†å¸ƒå¼é”è¦ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-åˆ†å¸ƒå¼é”è¦ç‚¹"}},[s._v("#")]),s._v(" 3.2 åˆ†å¸ƒå¼é”è¦ç‚¹")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("äº’æ–¥æ€§ï¼ŒåŒä¸€ä¸ªæ—¶åˆ»ï¼Œåªèƒ½æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯æŒæœ‰é”ï¼ˆSETNXï¼‰")])]),s._v(" "),a("li",[a("p",[s._v('é˜²æ­¢æ­»é”å‘ç”Ÿï¼Œå¦‚æœæŒæœ‰é”çš„å®¢æˆ·ç«¯çªç„¶å´©æºƒï¼Œæ²¡æœ‰ä¸»åŠ¨é‡Šæ”¾é”ï¼Œä¹Ÿè¦ä¿è¯é”æ­£å¸¸é‡Šæ”¾ï¼Œè®©å…¶ä»–å®¢æˆ·ç«¯å¯ä»¥æ­£å¸¸åŠ é”ã€‚ï¼ˆä¿æŒé”çš„åŸå­æ€§ï¼‰ã€‚è§£å†³æ–¹æ³•ï¼šé€šè¿‡åœ¨åˆ›å»ºé”çš„åŒæ—¶åŠ ä¸Šè¿‡æœŸæ—¶é—´æ¥å®ç°ï¼ŒredisTemplate.opsForValue().setIfAbsent("lock","123", 30, TimeUnit.SECONDS)')])]),s._v(" "),a("li",[a("p",[s._v("åŠ é”å’Œé‡Šæ”¾é”å¿…é¡»æ˜¯åŒä¸€ä¸ªå®¢æˆ·ç«¯ã€‚æ¡ˆä¾‹æƒ…å†µï¼šå½“é”è¿‡æœŸæ—¶é—´ä¸º30ç§’ï¼Œä¸šåŠ¡ä»£ç æ‰§è¡Œäº†50ç§’ï¼Œç»“æœé”ğŸ”’åœ¨ç¨‹åº30ç§’æ—¶å°±å·²ç»è¢«åˆ é™¤äº†ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªçº¿ç¨‹å·²ç»è·å–äº†é”ğŸ”’ï¼Œå½“ç¬¬ä¸€ä¸ªä¸šåŠ¡ä»£ç æ‰§è¡Œå®Œæˆåè¿›è¡Œåˆ é™¤é”ğŸ”’æ—¶ï¼Œç”±äºç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿæ˜¯æ‰§è¡Œ50ç§’ï¼Œåœ¨ç¬¬äºŒä¸ªçº¿ç¨‹æ‰§è¡Œ20ç§’æ—¶ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹æŠŠç¬¬äºŒä¸ªçº¿ç¨‹çš„é”ç»™åˆ æ‰äº†ï¼Œè¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼")]),s._v(" "),a("p",[s._v("è§£å†³æ–¹æ³•ï¼šé€šè¿‡ç»™é”çš„å€¼è®¾ç½®éšæœºå€¼ï¼Œåœ¨åˆ é™¤é”æ—¶ï¼Œè·å–é”çš„å€¼åˆ¤æ–­å½“å‰é”çš„å€¼æ˜¯å¦ç­‰äºç”Ÿæˆçš„éšæœºå€¼ï¼Œå¦‚æœç›¸ç­‰åˆ™åˆ é™¤é”ã€‚å¦åˆ™ä¸åˆ é™¤ï¼Œé”ç€ï¼Œåé¢çš„çº¿ç¨‹ä¹Ÿæ— æ³•è·å–é”ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("å®¹é”™æ€§ï¼Œåªè¦redisè¿˜æœ‰èŠ‚ç‚¹å­˜æ´»ï¼Œå°±å¯ä»¥è¿›è¡Œæ­£ç¡®çš„åŠ é”è§£é”æ“ä½œã€‚")])])]),s._v(" "),a("h3",{attrs:{id:"_3-3-redisåˆ†å¸ƒå¼é”çš„å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-redisåˆ†å¸ƒå¼é”çš„å®ç°"}},[s._v("#")]),s._v(" 3.3  redisåˆ†å¸ƒå¼é”çš„å®ç°")]),s._v(" "),a("h4",{attrs:{id:"é”™è¯¯å®ç°æ–¹å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é”™è¯¯å®ç°æ–¹å¼"}},[s._v("#")]),s._v(" é”™è¯¯å®ç°æ–¹å¼ï¼š")]),s._v(" "),a("p",[s._v("â€‹\tæ­¤å¤„æœ‰ä¸¤ç‚¹é”™è¯¯ï¼š1. redisé”å¹¶æ²¡æœ‰è®¾ç½®éšæœºå€¼ï¼Œä¿è¯æ¯æ¬¡åˆ é™¤é”æ—¶æ˜¯å½“å‰è¿›ç¨‹ï¼›2. redisè®¾ç½®è¿‡æœŸæ—¶é—´å¹¶ä¸æ˜¯åŸå­æ€§çš„ï¼Œå½“ç¨‹åºè¿è¡Œåˆ°è®¾ç½®è¿‡æœŸæ—¶é—´ä¹‹å‰å®•æœºäº†ï¼Œåˆ™ä¼šé€ æˆæ­»é”ç°è±¡ã€‚")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CategoryVo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCategoryJsonFromWithRedisLock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.å åˆ†å¸ƒå¼é” - è®¾ç½®è¿‡æœŸæ—¶é—´é˜²æ­¢ç¨‹åºçªç„¶æŒ‚æ‰åæ­»é”ç°è±¡")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" lock "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setIfAbsent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŠ é”æˆåŠŸï¼Œæ‰§è¡Œä¸šåŠ¡")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®è¿‡æœŸæ—¶é—´")]),s._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("expire")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SECONDS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CategoryVo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" dataFromDb "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getDataFromDb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" dataFromDb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŠ é”å¤±è´¥ï¼Œä¸æ–­é‡è¯•ï¼ˆ100msä¸€æ¬¡ï¼‰ - è‡ªæ—‹çš„æ€æƒ³")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCategoryJsonFromWithRedisLock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"æ­£ç¡®å®ç°æ–¹å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ­£ç¡®å®ç°æ–¹å¼"}},[s._v("#")]),s._v(" æ­£ç¡®å®ç°æ–¹å¼ï¼š")]),s._v(" "),a("p",[s._v("è®¾ç½®çš„keyå¿…é¡»è¦æœ‰è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢å´©æºƒæ—¶é”æ— æ³•é‡Šæ”¾")]),s._v(" "),a("p",[s._v("valueä½¿ç”¨å”¯ä¸€idæ ‡å¿—æ¯ä¸ªå®¢æˆ·ç«¯ï¼Œä¿è¯åªæœ‰é”çš„æŒæœ‰è€…æ‰å¯ä»¥é‡Šæ”¾é”")]),s._v(" "),a("p",[s._v("åŠ é”ç›´æ¥ä½¿ç”¨setå‘½ä»¤åŒæ—¶è®¾ç½®å”¯ä¸€idå’Œè¿‡æœŸæ—¶é—´ï¼›")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CategoryVo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCategoryJsonFromWithRedisLock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" uuid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UUID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.å åˆ†å¸ƒå¼é” - è®¾ç½®è¿‡æœŸæ—¶é—´é˜²æ­¢ç¨‹åºçªç„¶æŒ‚æ‰åæ­»é”ç°è±¡")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Boolean")]),s._v(" lock "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setIfAbsent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uuid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SECONDS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŠ é”æˆåŠŸï¼Œæ‰§è¡Œä¸šåŠ¡")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®è¿‡æœŸæ—¶é—´")]),s._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("expire")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SECONDS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CategoryVo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" dataFromDb "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getDataFromDb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ é™¤é”")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" lockValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uuid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lockValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ é™¤è‡ªå·±çš„é”ï¼Œä¸ä¼šåˆ é™¤åˆ«äººçš„")]),s._v("\n            redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" dataFromDb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŠ é”å¤±è´¥ï¼Œä¸æ–­é‡è¯•ï¼ˆ100msä¸€æ¬¡ï¼‰ - è‡ªæ—‹çš„æ€æƒ³")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCategoryJsonFromWithRedisLock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);