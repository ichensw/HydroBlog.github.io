(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{556:function(v,e,_){"use strict";_.r(e);var a=_(3),r=Object(a.a)({},(function(){var v=this,e=v.$createElement,_=v._self._c||e;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("p",[_("img",{attrs:{src:"https://gitee.com/ichensw/drawing-bed/raw/master/image/76.png",alt:"76"}})]),v._v(" "),_("h1",{attrs:{id:"springcloud总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#springcloud总结"}},[v._v("#")]),v._v(" SpringCloud总结")]),v._v(" "),_("h2",{attrs:{id:"什么springcloud"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#什么springcloud"}},[v._v("#")]),v._v(" 什么springCloud")]),v._v(" "),_("h3",{attrs:{id:"在springboot的基础上构建的微服务框架"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#在springboot的基础上构建的微服务框架"}},[v._v("#")]),v._v(" 在springboot的基础上构建的微服务框架")]),v._v(" "),_("h3",{attrs:{id:"_1-引入组件的启动器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-引入组件的启动器"}},[v._v("#")]),v._v(" 1.引入组件的启动器")]),v._v(" "),_("h3",{attrs:{id:"_2-覆盖默认配置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-覆盖默认配置"}},[v._v("#")]),v._v(" 2.覆盖默认配置")]),v._v(" "),_("h3",{attrs:{id:"_3-在引导类上添加相应的注解"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-在引导类上添加相应的注解"}},[v._v("#")]),v._v(" 3.在引导类上添加相应的注解")]),v._v(" "),_("h2",{attrs:{id:"eureka"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#eureka"}},[v._v("#")]),v._v(" eureka")]),v._v(" "),_("h3",{attrs:{id:"注册中心-服务的注册与发现"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#注册中心-服务的注册与发现"}},[v._v("#")]),v._v(" 注册中心，服务的注册与发现")]),v._v(" "),_("h3",{attrs:{id:"服务端"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#服务端"}},[v._v("#")]),v._v(" 服务端")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("1.引入服务端启动器：eureka-server")])]),v._v(" "),_("li",[_("p",[v._v("2.添加了配置")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("spring.applicaiton.name")]),v._v(" "),_("ul",[_("li",[v._v("服务名")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.client.service-url.defaultZone")]),v._v(" "),_("ul",[_("li",[v._v("http://localhost:10086/eureka")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.server.eviction-interval-timer-in-ms")]),v._v(" "),_("ul",[_("li",[v._v("剔除无效连接的间隔时间")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.server.enable-self-preservation")]),v._v(" "),_("ul",[_("li",[v._v("关闭自我保护")])])])])]),v._v(" "),_("li",[_("p",[v._v("3.@EnableEurekaServer")]),v._v(" "),_("ul",[_("li",[v._v("开启eureka服务端功能")])])])]),v._v(" "),_("h3",{attrs:{id:"客户端"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#客户端"}},[v._v("#")]),v._v(" 客户端")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("1.引入启动器：eureka-client")])]),v._v(" "),_("li",[_("p",[v._v("2.添加配置")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("spring.application.name")])]),v._v(" "),_("li",[_("p",[v._v("eureka.client.service-url.defaultZone")])]),v._v(" "),_("li",[_("p",[v._v("eureka.instance.lease-renewal-interval-in-seconds")]),v._v(" "),_("ul",[_("li",[v._v("心跳时间")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.instance.lease-expiration-duration-in-seconds")]),v._v(" "),_("ul",[_("li",[v._v("过期时间")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.client.register-with-eureka")]),v._v(" "),_("ul",[_("li",[v._v("是否注册给eureka容器")]),v._v(" "),_("li",[v._v("默认true")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.client.fetch-registry")]),v._v(" "),_("ul",[_("li",[v._v("是否拉取服务列表")]),v._v(" "),_("li",[v._v("默认true")])])]),v._v(" "),_("li",[_("p",[v._v("eureka.client.registry-fetch-interval-seconds")]),v._v(" "),_("ul",[_("li",[v._v("拉取服务的间隔时间")])])])])]),v._v(" "),_("li",[_("p",[v._v("3.@EnableDiscoveryClient")]),v._v(" "),_("ul",[_("li",[v._v("启用eureka客户端")])])])]),v._v(" "),_("h2",{attrs:{id:"ribbon"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ribbon"}},[v._v("#")]),v._v(" ribbon")]),v._v(" "),_("h3",{attrs:{id:"负载均衡组件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡组件"}},[v._v("#")]),v._v(" 负载均衡组件")]),v._v(" "),_("h3",{attrs:{id:"eureka、feign以及zuul已集成"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#eureka、feign以及zuul已集成"}},[v._v("#")]),v._v(" eureka、feign以及zuul已集成")]),v._v(" "),_("h3",{attrs:{id:"配置负载均衡策略"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#配置负载均衡策略"}},[v._v("#")]),v._v(" 配置负载均衡策略")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("<服务名>.ribbon.NFLoadBalancerRuleClassName")]),v._v(" "),_("ul",[_("li",[v._v("负载均衡策略的全路径")])])])]),v._v(" "),_("h3",{attrs:{id:"loadbalanced"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#loadbalanced"}},[v._v("#")]),v._v(" @LoadBalanced")]),v._v(" "),_("ul",[_("li",[v._v("在RestTemplate的@Bean方法上")])]),v._v(" "),_("h2",{attrs:{id:"hystrix"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#hystrix"}},[v._v("#")]),v._v(" hystrix")]),v._v(" "),_("h3",{attrs:{id:"容错组件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#容错组件"}},[v._v("#")]),v._v(" 容错组件")]),v._v(" "),_("h3",{attrs:{id:"降级"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#降级"}},[v._v("#")]),v._v(" 降级")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("1.引入hystrix的启动器")])]),v._v(" "),_("li",[_("p",[v._v("2.添加配置，超时时间的配置")])]),v._v(" "),_("li",[_("p",[v._v("3.@EnableCircuitBreaker")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("启用熔断组件")])]),v._v(" "),_("li",[_("p",[v._v("@SpringCloudApplication")]),v._v(" "),_("ul",[_("li",[v._v("@SpringBootApplication")]),v._v(" "),_("li",[v._v("@EnableDiscveryClient")])])])])]),v._v(" "),_("li",[_("p",[v._v("代码")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("局部")]),v._v(" "),_("ul",[_("li",[v._v("返回值和参数列表和被熔断的方法一致")]),v._v(" "),_("li",[v._v('在被熔断的方法上@HystrixCommand(fallbackMethod="熔断方法名")')])])]),v._v(" "),_("li",[_("p",[v._v("全局")]),v._v(" "),_("ul",[_("li",[v._v("返回值和被熔断的方法返回值一致，不能有参数列表")]),v._v(" "),_("li",[v._v('在类上@DefaultProperties(defaultFallbck="全局熔断方法名")')]),v._v(" "),_("li",[v._v("在具体的被熔断方法上@HystrixCommand")])])])])])]),v._v(" "),_("h3",{attrs:{id:"熔断"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#熔断"}},[v._v("#")]),v._v(" 熔断")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("close")]),v._v(" "),_("ul",[_("li",[v._v("关闭状态")]),v._v(" "),_("li",[v._v("所有请求都正常访问")])])]),v._v(" "),_("li",[_("p",[v._v("open")]),v._v(" "),_("ul",[_("li",[v._v("打开状态")]),v._v(" "),_("li",[v._v("所有请求都无法访问")]),v._v(" "),_("li",[v._v("触发：连续失败的比例大于50%或者失败次数不少于20")]),v._v(" "),_("li",[v._v("维持5s的休眠时间")])])]),v._v(" "),_("li",[_("p",[v._v("half open")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("半开状态")])]),v._v(" "),_("li",[_("p",[v._v("释放部分请求通过")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("正常")]),v._v(" "),_("ul",[_("li",[v._v("close")])])]),v._v(" "),_("li",[_("p",[v._v("不正常")]),v._v(" "),_("ul",[_("li",[v._v("open")])])])])]),v._v(" "),_("li",[_("p",[v._v("触发：休眠时间之后")])])])])]),v._v(" "),_("h2",{attrs:{id:"feign"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#feign"}},[v._v("#")]),v._v(" feign")]),v._v(" "),_("h3",{attrs:{id:"远程调用组件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#远程调用组件"}},[v._v("#")]),v._v(" 远程调用组件")]),v._v(" "),_("ul",[_("li",[v._v("集成ribbon和hystrix")]),v._v(" "),_("li",[v._v("使代码更加优雅")])]),v._v(" "),_("h3",{attrs:{id:"_1-引入feign的启动器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-引入feign的启动器"}},[v._v("#")]),v._v(" 1.引入feign的启动器")]),v._v(" "),_("h3",{attrs:{id:"_2-feign-hystrix-enable-true"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-feign-hystrix-enable-true"}},[v._v("#")]),v._v(" 2.feign.hystrix.enable=true")]),v._v(" "),_("ul",[_("li",[v._v("开启熔断")])]),v._v(" "),_("h3",{attrs:{id:"_3-enablefeignclients"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-enablefeignclients"}},[v._v("#")]),v._v(" 3.@EnableFeignClients")]),v._v(" "),_("ul",[_("li",[v._v("开启feign的功能")])]),v._v(" "),_("h3",{attrs:{id:"代码"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[v._v("#")]),v._v(" 代码")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("定义一个接口")]),v._v(" "),_("ul",[_("li",[v._v('@FeignClient(value="服务名", fallback=实现类.class)')]),v._v(" "),_("li",[v._v("方法上的注解使用的都是springMVC的注解")])])])]),v._v(" "),_("h2",{attrs:{id:"zuul"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#zuul"}},[v._v("#")]),v._v(" zuul")]),v._v(" "),_("h3",{attrs:{id:"网关组件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#网关组件"}},[v._v("#")]),v._v(" 网关组件")]),v._v(" "),_("ul",[_("li",[v._v("路由")]),v._v(" "),_("li",[v._v("过滤器")])]),v._v(" "),_("h3",{attrs:{id:"_1-引入启动器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-引入启动器"}},[v._v("#")]),v._v(" 1.引入启动器")]),v._v(" "),_("h3",{attrs:{id:"_2-添加配置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加配置"}},[v._v("#")]),v._v(" 2.添加配置")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("路由的配置")])]),v._v(" "),_("li",[_("p",[v._v("zuul.prefix")]),v._v(" "),_("ul",[_("li",[v._v("路由前缀")])])]),v._v(" "),_("li",[_("p",[v._v("四种路由配置方式")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("zuul.routes.<路由名>.path=/service-provider/**\nzuul.routes.<路由名>.url=http://localhost:8081")])]),v._v(" "),_("li",[_("p",[v._v("zuul.routes.<路由名>.path=/service-provider/**\nzuul.routes.<路由名>.serviceId=service-provider")])]),v._v(" "),_("li",[_("p",[v._v("zuul.routes.<路由名:服务名>=/service-provider/**")])]),v._v(" "),_("li",[_("p",[v._v("不配置")]),v._v(" "),_("ul",[_("li",[v._v("默认服务的入口就是以服务名为前缀")])])])])])]),v._v(" "),_("h3",{attrs:{id:"_3-enablezuulproxy"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-enablezuulproxy"}},[v._v("#")]),v._v(" 3.@EnableZuulProxy")]),v._v(" "),_("ul",[_("li",[v._v("开启zuul网关组件")])]),v._v(" "),_("h3",{attrs:{id:"自定义过滤器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#自定义过滤器"}},[v._v("#")]),v._v(" 自定义过滤器")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("IZuulFilter")]),v._v(" "),_("ul",[_("li",[v._v("默认的抽象实现类：ZuulFilter")])])]),v._v(" "),_("li",[_("p",[v._v("filterType")]),v._v(" "),_("ul",[_("li",[v._v("pre")]),v._v(" "),_("li",[v._v("post")]),v._v(" "),_("li",[v._v("route")]),v._v(" "),_("li",[v._v("error")])])]),v._v(" "),_("li",[_("p",[v._v("filterOrder")]),v._v(" "),_("ul",[_("li",[v._v("执行顺序，返回值越小优先级越高")])])]),v._v(" "),_("li",[_("p",[v._v("shouldFilter")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("是否执行run方法")])]),v._v(" "),_("li",[_("p",[v._v("true")]),v._v(" "),_("ul",[_("li",[v._v("执行")])])])])]),v._v(" "),_("li",[_("p",[v._v("run")]),v._v(" "),_("ul",[_("li",[v._v("过滤器的具体逻辑")])])]),v._v(" "),_("li",[_("p",[v._v("四种执行顺序")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("pre--\x3eroute--\x3epost")])]),v._v(" "),_("li",[_("p",[v._v("异常")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("pre或者route出现异常")]),v._v(" "),_("ul",[_("li",[v._v("直接执行error--\x3epost")])])]),v._v(" "),_("li",[_("p",[v._v("post出现异常")]),v._v(" "),_("ul",[_("li",[v._v("error--\x3e响应")])])]),v._v(" "),_("li",[_("p",[v._v("error出现异常")]),v._v(" "),_("ul",[_("li",[v._v("error--\x3epost")])])])])])])])])])}),[],!1,null,null,null);e.default=r.exports}}]);